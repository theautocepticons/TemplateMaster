(()=>{function le(e,t={}){let{topRight:a=!0,bottomLeft:n=!0}=t;if(e.querySelectorAll(".glow-effect").forEach(r=>r.remove()),a){let r=document.createElement("span");r.className="glow-effect glow-effect--shine",e.appendChild(r);let d=document.createElement("span");d.className="glow-effect glow-effect--glow",e.appendChild(d);let o=document.createElement("span");o.className="glow-effect glow-effect--glow glow-effect--glow-bright",e.appendChild(o)}if(n){let r=document.createElement("span");r.className="glow-effect glow-effect--shine glow-effect--bottom",e.appendChild(r);let d=document.createElement("span");d.className="glow-effect glow-effect--glow glow-effect--bottom",e.appendChild(d);let o=document.createElement("span");o.className="glow-effect glow-effect--glow glow-effect--glow-bright glow-effect--bottom",e.appendChild(o)}}function re(){document.querySelectorAll(".btn").forEach(e=>{le(e)})}function ce(e){let t=document.querySelector(e);if(!t)return;let a=t.querySelector(".custom-select-trigger"),n=t.querySelector(".custom-select-dropdown"),r=t.querySelectorAll(".custom-select-option"),d=t.querySelector(".select-value"),o=t.querySelector("select");a.addEventListener("click",l=>{l.stopPropagation();let c=t.classList.contains("open");H(),c||(t.classList.add("open"),a.setAttribute("aria-expanded","true"))}),r.forEach(l=>{l.addEventListener("click",()=>{let c=l.getAttribute("data-value"),i=l.textContent;d.textContent=i,o&&(o.value=c,o.dispatchEvent(new Event("change"))),r.forEach(s=>{s.classList.remove("selected"),s.setAttribute("aria-selected","false")}),l.classList.add("selected"),l.setAttribute("aria-selected","true"),t.classList.remove("open"),a.setAttribute("aria-expanded","false")})}),a.addEventListener("keydown",l=>{l.key==="Enter"||l.key===" "?(l.preventDefault(),a.click()):l.key==="Escape"&&(t.classList.remove("open"),a.setAttribute("aria-expanded","false"))})}function H(){document.querySelectorAll(".custom-select.open").forEach(e=>{e.classList.remove("open"),e.querySelector(".custom-select-trigger")?.setAttribute("aria-expanded","false")})}document.addEventListener("click",H);var u="checked",f="N/A",$="[Not specified]";function b(e){return e===u?"Yes":"No"}function R(e,t=6){return!e||e===f||e===$?e:e.length>t?"..."+e.slice(-t):e}function de(e,t){if(!e||e.length===0)return"";let a=`

REPLACED PARTS (${e.length}):`;return e.forEach(n=>{let r=R(n.oldSerialNumber||f),d=R(n.newSerialNumber||f),o=n.licensePlate||f,l=`
\u2022 ${r} \u2192 ${d} (LP: ${o})`;if(t==="dbd"){let c=n.driveLocation||f,i=n.binNumber||f;l+=` | Loc: ${c}, Bin: ${i}`}a+=l}),a}function ie(e){if(!e||e.length===0)return"";let t=`

MOVED DBDs (${e.length}):`;return e.forEach(a=>{let n=R(a.dbdSerialNumber||f),r=a.slotNumber||f;t+=`
\u2022 ${n} (Slot: ${r})`}),t}function S(e){return e.wasEscalated===u?`

ESCALATION DETAILS:
- Escalated To: ${e.escalatedTo||$}
- Senior Tech Approval: ${e.seniorTechAlias||$}`:""}function G(e){let t;if(e.type==="textarea")t=document.createElement("textarea");else if(e.type==="select"&&e.options){t=document.createElement("select");let a=document.createElement("option");a.value="",a.textContent="-- Select --",t.appendChild(a),e.options.forEach(n=>{let r=document.createElement("option");r.value=n,r.textContent=n,t.appendChild(r)})}else e.type==="checkbox"?(t=document.createElement("input"),t.type="checkbox"):(t=document.createElement("input"),t.type=e.type);return e.name&&(t.id=e.name,t.name=e.name),t}function W(e){let t=document.createElement("div");return t.style.padding="12px",t.style.backgroundColor="var(--highlight-bg)",t.style.borderLeft="3px solid var(--primary-color)",t.style.borderRadius="4px",t.style.fontSize="14px",t.style.lineHeight="1.5",t.style.color="var(--text-color)",t.style.overflowWrap="break-word",t.style.wordBreak="break-word",e&&e.includes("<")?t.innerHTML=e:t.textContent=e,t}var A=[{name:"taskId",label:"Task ID",type:"text"},{name:"assetTagConfirmed",label:"Was the asset tag visually confirmed?",type:"checkbox"},{name:"uponArrival",label:"Upon Arrival:",type:"textarea"}],B=[{name:"partReplaced",label:"Part(s) replaced?",type:"checkbox",hasConditionalFields:!0},{name:"oldSerialNumber",label:"Old Serial Number",type:"text",conditionalOn:{field:"partReplaced",value:u}},{name:"newSerialNumber",label:"New Serial Number",type:"text",conditionalOn:{field:"partReplaced",value:u}},{name:"licensePlate",label:"License Plate",type:"text",conditionalOn:{field:"partReplaced",value:u}}],D=[{name:"actionsTaken",label:"Actions Taken",type:"textarea"},{name:"wasEscalated",label:"Was this ticket escalated?",type:"checkbox",hasConditionalFields:!0},{name:"escalatedTo",label:"Who was it escalated to?",type:"text",conditionalOn:{field:"wasEscalated",value:u}},{name:"seniorTechAlias",label:"Alias of the senior who approved this:",type:"text",conditionalOn:{field:"wasEscalated",value:u}}],T={breakfix:{title:"Break/Fix Task Notes",fields:[...A,...B,...D],format:e=>`TASK ID: ${e.taskId||"[No ID]"}
ASSET TAG CONFIRMED: ${b(e.assetTagConfirmed)}

UPON ARRIVAL:
${e.uponArrival||"[No arrival notes recorded]"}

ACTIONS TAKEN:
${e.actionsTaken||"[No actions recorded]"}

TICKET ESCALATED: ${b(e.wasEscalated)}${S(e)}`},network:{title:"Network Task Notes",fields:[...A,{name:"sourceDevice",label:"Source Device:Port",type:"text"},{name:"endDevice",label:"End Device:Port",type:"text"},...B,...D],format:e=>`TASK ID: ${e.taskId||"[No ID]"}
ASSET TAG CONFIRMED: ${b(e.assetTagConfirmed)}

UPON ARRIVAL:
${e.uponArrival||"[No arrival notes recorded]"}
SOURCE DEVICE:PORT: ${e.sourceDevice||f}
END DEVICE:PORT: ${e.endDevice||f}

ACTIONS TAKEN:
${e.actionsTaken||"[No actions recorded]"}

TICKET ESCALATED: ${b(e.wasEscalated)}${S(e)}`},dbd:{title:"DBD Task Notes",fields:[...A,...B,{name:"driveLocation",label:"Location of drive being replaced",type:"text",conditionalOn:{field:"partReplaced",value:u}},{name:"binNumber",label:"Bin #",type:"text",conditionalOn:{field:"partReplaced",value:u}},...D],format:e=>`TASK ID: ${e.taskId||"[No ID]"}
ASSET TAG CONFIRMED: ${b(e.assetTagConfirmed)}

UPON ARRIVAL:
${e.uponArrival||"[No arrival notes recorded]"}

ACTIONS TAKEN:
${e.actionsTaken||"[No actions recorded]"}

TICKET ESCALATED: ${b(e.wasEscalated)}${S(e)}`},mobo:{title:"Motherboard Task Notes",fields:[...A,{name:"partReplaced",label:"Part(s) replaced?",type:"checkbox",hasConditionalFields:!0},{name:"oldSerialNumber",label:"Old Motherboard Serial Number",type:"text",conditionalOn:{field:"partReplaced",value:u}},{name:"newSerialNumber",label:"New Motherboard Serial Number",type:"text",conditionalOn:{field:"partReplaced",value:u}},{name:"licensePlate",label:"License Plate",type:"text",conditionalOn:{field:"partReplaced",value:u}},{name:"dbdMoved",label:"Were DBDs moved from old motherboard to new?",type:"checkbox",hasConditionalFields:!0},{name:"dbdSerialNumber",label:"DBD Serial Number",type:"text",conditionalOn:{field:"dbdMoved",value:u}},{name:"slotNumber",label:"Slot #",type:"text",conditionalOn:{field:"dbdMoved",value:u}},...D],format:e=>`TASK ID: ${e.taskId||"[No ID]"}
ASSET TAG CONFIRMED: ${b(e.assetTagConfirmed)}

UPON ARRIVAL:
${e.uponArrival||"[No arrival notes recorded]"}

ACTIONS TAKEN:
${e.actionsTaken||"[No actions recorded]"}

TICKET ESCALATED: ${b(e.wasEscalated)}${S(e)}`},workwindow:{title:"Work Window Request Email",fields:[{type:"info",text:'You can confirm availability for a specific dates via <a href="https://dccentral.microsoft.com/tasks/query/advanced/30704" target="_blank">SN-DCCentral</a> for SN or <a href="https://dccentral.microsoft.com/tasks/query/advanced/31722" target="_blank">SAT-DCCentral</a> for SAT. Our work window policy can be found <a href="https://microsoft.sharepoint.com/:w:/r/teams/dcops/reflib/_layouts/15/Doc.aspx?sourcedoc=%7B34AC5FCF-C562-4F64-922F-AD9AED915DEA%7D&file=Work%20Window%20Policy.docx&wdOrigin=TEAMS-MAGLEV.teams_ns.rwc&action=default&mobileredirect=true" target="_blank">here</a> for reference.'},{name:"taskId",label:"Task ID",type:"text"},{name:"date",label:"Suggested Date",type:"text"},{name:"time",label:"Time of Availability",type:"text"},{type:"info",text:'If a task is quarantined, please direct the requestor to <a href="https://microsoft.sharepoint.com/sites/COIPartnerResourceCenter/SitePages/CO+-Partner-Resource-Center.aspx?ct=1748876712863&or=Teams-HL&ga=1&LOF=1&xsdata=MDV8MDJ8fDdlZjg4MTg4OGJiMjQ0MzBhMTFjMDhkZTFhMTY3ODAwfDcyZjk4OGJmODZmMTQxYWY5MWFiMmQ3Y2QwMTFkYjQ3fDB8MHw2Mzg5NzY4ODA5MzgxMTkxMDB8VW5rbm93bnxWR1ZoYlhOVFpXTjFjbWwwZVZObGNuWnBZMlY4ZXlKRFFTSTZJbFJsWVcxelgwRlVVRk5sY25acFkyVmZVMUJQVEU5R0lpd2lWaUk2SWpBdU1DNHdNREF3SWl3aVVDSTZJbGRwYmpNeUlpd2lRVTRpT2lKUGRHaGxjaUlzSWxkVUlqb3hNWDA9fDF8TDJOb1lYUnpMekU1T21KaVpHTm1OalUzTWpZNFpqUXhNVGs1Tm1Nek5UZGxObU16TnpFeFptTTNRSFJvY21WaFpDNTJNaTl0WlhOellXZGxjeTh4TnpZeU1Ea3hNamt5T0Rnd3w4YTcwMGYyOTdiZDE0NzE0YzkwNDA4ZGUxYTE2NzdmZnxlNzQ5NGE4MjI3NjI0N2Q5OGYwMTNlNDI2ZWFiMmI5ZA%3D%3D&sdata=ZGtMSy9JZVhOYlRFRnFHV1M0MlFWc1pQbEp1OXArZWdoSnpBVGY0bDlUbz0%3D&ovuser=72f988bf-86f1-41af-91ab-2d7cd011db47%2Caguajardo%40microsoft.com&OR=Teams-HL&CT=1762904435825&clickparams=eyJBcHBOYW1lIjoiVGVhbXMtRGVza3RvcCIsIkFwcFZlcnNpb24iOiI0OS8yNTExMDYxMzYwMSIsIkhhc0ZlZGVyYXRlZFVzZXIiOmZhbHNlfQ%3D%3D" target="_blank">the CO&I Partner Resource Center</a> for further instructions on how to proceed with scheduling work windows for quarantined tasks.'}],format:e=>`WORK WINDOW REQUEST - TASK ID: ${e.taskId||"TaskIdHolder"}

Hello,

We are writing to schedule a work window for Task #${e.taskId||"TaskIdHolder"}. We are available to begin a work window between 09:00 AM CST and 02:00 PM CST or 09:00 PM CST and 02:00 AM CST. Our next available window is available for ${e.date||"DATE"} at ${e.time||"TIME"}. Please confirm whether this time is acceptable for your team.

Important considerations:
\u2022 A minimum of 24 hours' notice is required for all work windows to ensure System Services can confirm availability and prepare accordingly.
\u2022 Prompt confirmation is essential. Delayed replies may result in the proposed time slot becoming unavailable, as our resources are limited and we cannot reserve slots indefinitely.
\u2022 Please ensure all necessary traffic is removed or rerouted prior to the work window start time to facilitate a timely and efficient completion of the requested work.

We appreciate your prompt attention to this matter.`},workAuth:{title:"Work Authorization Request",fields:[{name:"taskId",label:"Task ID",type:"text"},{name:"taskLink",label:"Task Link",type:"text"},{name:"sourceDevice",label:"Source Device:Port",type:"text"},{name:"expectedHop",label:"Expected Hop (leave empty if unknown)",type:"text"},{name:"endDevice",label:"End Device:Port",type:"text"},{name:"actionsTaken",label:"Actions being taken",type:"text"},{name:"assetTagConfirmed",label:"Was the asset tag visually confirmed?",type:"checkbox"},{name:"labelConfirmed",label:"Was the cable label visually confirmed?",type:"checkbox"},{name:"secondTech",label:"Alias of Second Tech QC",type:"text"}],format:e=>`LINK APPROVAL REQUEST - TASK ID: ${e.taskId||"N/A"}

Task Link: ${e.taskLink||"N/A"}
Source Device:Port: ${e.sourceDevice||"N/A"}
Expected Hop: ${e.expectedHop||"N/A"}
End Device:Port: ${e.endDevice||"N/A"}
Required Actions: ${e.actionsTaken||"N/A"}

Asset Tag Confirmed: ${b(e.assetTagConfirmed)}
Cable Label Verified: ${b(e.labelConfirmed)}
2nd Tech QC Alias: ${e.secondTech||"N/A"}`}},p="breakfix",k=0,N=0,y=document.getElementById("template-form"),Y=document.getElementById("preview"),K=document.getElementById("template-select"),se=document.getElementById("copy-btn"),me=document.getElementById("reset-btn"),q=document.getElementById("copy-message"),z=document.getElementById("app"),Q=document.getElementById("details-panel"),F=document.getElementById("details-content"),E=new Set;ee();re();ce("#template-select-wrapper");K.addEventListener("change",Ee);se.addEventListener("click",Te);me.addEventListener("click",ke);function pe(){Q.classList.add("visible"),z.classList.add("has-details")}function M(){Q.classList.remove("visible"),z.classList.remove("has-details"),F.innerHTML="",E.clear()}function ue(){if(F.innerHTML="",E.size===0){M();return}pe(),E.forEach(e=>{ye(e)})}var O=document.getElementById("mode-toggle"),j=document.getElementById("animation-toggle"),J=document.querySelectorAll('.color-buttons[data-color-type="primary"] .color-btn'),X=document.querySelectorAll('.color-buttons[data-color-type="secondary"] .color-btn'),be=document.getElementById("settings-btn"),g=document.getElementById("settings-modal"),fe=document.getElementById("modal-close"),he={blue:222,purple:280,green:145,red:0,orange:30,cyan:190},x=localStorage.getItem("darkMode")==="true",C=localStorage.getItem("primaryColor")||"blue",w=localStorage.getItem("secondaryColor")||"none",v=localStorage.getItem("animatedBackground")!=="false";L();be.addEventListener("click",()=>{g.classList.add("show")});fe.addEventListener("click",()=>{g.classList.remove("show")});g.addEventListener("click",e=>{e.target===g&&g.classList.remove("show")});O.addEventListener("click",function(){x=!x,localStorage.setItem("darkMode",x),L()});j.addEventListener("click",function(){v=!v,localStorage.setItem("animatedBackground",v),_()});function _(){j.textContent=v?"\u25B6\uFE0F":"\u23F8\uFE0F",window.waveBackground&&window.waveBackground.setAnimated(v)}_();J.forEach(e=>{e.addEventListener("click",function(){C=this.getAttribute("data-color"),localStorage.setItem("primaryColor",C),L()})});X.forEach(e=>{e.addEventListener("click",function(){w=this.getAttribute("data-color"),localStorage.setItem("secondaryColor",w),L()})});function L(){x?(document.body.classList.add("dark-mode"),O.textContent="\u{1F319}"):(document.body.classList.remove("dark-mode"),O.textContent="\u2600\uFE0F"),document.body.classList.remove("primary-blue","primary-purple","primary-green","primary-red","primary-orange","primary-cyan","secondary-blue","secondary-purple","secondary-green","secondary-red","secondary-orange","secondary-cyan"),document.body.classList.add(`primary-${C}`),w!=="none"?(document.body.classList.add(`secondary-${w}`),document.documentElement.style.removeProperty("--hue2")):document.documentElement.style.setProperty("--hue2",he[C]),J.forEach(e=>{e.classList.toggle("active",e.getAttribute("data-color")===C)}),X.forEach(e=>{e.classList.toggle("active",e.getAttribute("data-color")===w)}),window.waveBackground&&window.waveBackground.updateTheme()}function Ee(){let e=p,t=K.value,a=e==="network"&&t==="workAuth"||e==="workAuth"&&t==="network",n={};a&&T[e].fields.forEach(d=>{if(d.name){let o=document.getElementById(d.name);o&&(d.type==="checkbox"?n[d.name]=o.checked:n[d.name]=o.value)}}),p=t,ee(),a&&T[p].fields.forEach(d=>{if(d.name&&n[d.name]!==void 0){let o=document.getElementById(d.name);o&&(d.type==="checkbox"?(o.checked=n[d.name],d.hasConditionalFields&&te(o)):o.value=n[d.name])}}),m()}function ee(){y.innerHTML="",k=0,N=0;let e=T[p],t=[],a=[],n=[],r=!1;e.fields.forEach(o=>{o.conditionalOn||(o.type==="info"?r?a.push(o):t.push(o):(r=!0,n.push(o)))}),t.forEach(o=>{let l=W(o.text||o.label);l.style.marginBottom="15px",y.appendChild(l)});let d=document.createElement("tbody");n.forEach(o=>{let l=document.createElement("tr"),c=document.createElement("td"),i=document.createElement("label");i.setAttribute("for",o.name),i.textContent=o.label,c.appendChild(i);let s=document.createElement("td"),h=G(o);o.type==="checkbox"&&o.hasConditionalFields?h.addEventListener("change",function(){te(this),m()}):o.type==="select"&&o.hasConditionalFields?h.addEventListener("change",ve):o.type==="select"?h.addEventListener("change",m):h.addEventListener("input",m),s.appendChild(h),l.appendChild(c),l.appendChild(s),d.appendChild(l)}),d.children.length>0&&y.appendChild(d),a.forEach(o=>{let l=W(o.text||o.label);l.style.marginTop="15px",y.appendChild(l)}),M()}function te(e){e.checked?E.add(e.id):(E.delete(e.id),e.id==="partReplaced"&&(k=0),e.id==="dbdMoved"&&(N=0)),ue()}function ye(e){let t=T[p],a=document.createElement("div");if(a.className="details-section",a.dataset.sectionId=e,E.size>1){let n=document.createElement("h4");n.className="section-subheader",e==="partReplaced"&&(n.textContent="Parts Replacement"),e==="wasEscalated"&&(n.textContent="Escalation Details"),e==="dbdMoved"&&(n.textContent="DBD Information"),a.appendChild(n)}if(e==="partReplaced"&&["breakfix","dbd","network","mobo"].includes(p)){if(p==="dbd"){let o=document.createElement("h4");o.className="details-section-label",o.textContent="Replaced DBDs",a.appendChild(o)}let n=document.createElement("table");if(n.id="parts-table",n.className="parts-table",p!=="dbd"){let o=document.createElement("thead"),l=document.createElement("tr");["Old Serial","New Serial","License Plate",""].forEach(i=>{let s=document.createElement("th");s.textContent=i,l.appendChild(s)}),o.appendChild(l),n.appendChild(o)}let r=document.createElement("tbody");r.id="parts-table-body",r.appendChild(ne(0)),n.appendChild(r),a.appendChild(n);let d=document.createElement("div");d.className="add-more-link",d.textContent="+ Add Another Part",d.addEventListener("click",ge),a.appendChild(d)}if(e==="dbdMoved"&&p==="mobo"){let n=document.createElement("table");n.id="dbds-table",n.className="parts-table";let r=document.createElement("thead"),d=document.createElement("tr");["DBD Serial","Slot #",""].forEach(i=>{let s=document.createElement("th");s.textContent=i,d.appendChild(s)}),r.appendChild(d),n.appendChild(r);let l=document.createElement("tbody");l.id="dbds-table-body",l.appendChild(ae(0)),n.appendChild(l),a.appendChild(n);let c=document.createElement("div");c.className="add-more-link",c.textContent="+ Add Another DBD",c.addEventListener("click",Ce),a.appendChild(c)}e==="wasEscalated"&&t.fields.filter(r=>r.conditionalOn&&r.conditionalOn.field==="wasEscalated").forEach(r=>{let d=document.createElement("div");d.className="form-group";let o=document.createElement("label");o.setAttribute("for",r.name),o.textContent=r.label;let l=G(r);l.addEventListener("input",m),d.appendChild(o),d.appendChild(l),a.appendChild(d)}),F.appendChild(a)}function ne(e){if(p==="dbd"){let d=document.createDocumentFragment(),o=document.createElement("tr");o.dataset.rowIndex=e,o.className="parts-row-primary";let l=document.createElement("td"),c=document.createElement("input");c.type="text",c.name=`oldSerialNumber${e}`,c.id=`oldSerialNumber${e}`,c.placeholder="Old Serial",c.addEventListener("input",m),l.appendChild(c),o.appendChild(l),l=document.createElement("td"),c=document.createElement("input"),c.type="text",c.name=`newSerialNumber${e}`,c.id=`newSerialNumber${e}`,c.placeholder="New Serial",c.addEventListener("input",m),l.appendChild(c),o.appendChild(l),l=document.createElement("td"),c=document.createElement("input"),c.type="text",c.name=`licensePlate${e}`,c.id=`licensePlate${e}`,c.placeholder="LP",c.addEventListener("input",m),l.appendChild(c),o.appendChild(l),l=document.createElement("td"),l.rowSpan=2;let i=document.createElement("button");i.type="button",i.className="delete-row-btn",i.textContent="\xD7",i.addEventListener("click",function(){Z(o,s)}),l.appendChild(i),o.appendChild(l);let s=document.createElement("tr");return s.dataset.rowIndex=e,s.className="parts-row-secondary",l=document.createElement("td"),l.colSpan=2,c=document.createElement("input"),c.type="text",c.name=`driveLocation${e}`,c.id=`driveLocation${e}`,c.placeholder="Drive Location",c.addEventListener("input",m),l.appendChild(c),s.appendChild(l),l=document.createElement("td"),c=document.createElement("input"),c.type="text",c.name=`binNumber${e}`,c.id=`binNumber${e}`,c.placeholder="Bin #",c.addEventListener("input",m),l.appendChild(c),s.appendChild(l),d.appendChild(o),d.appendChild(s),d}let t=document.createElement("tr");t.dataset.rowIndex=e;let a=document.createElement("td"),n=document.createElement("input");n.type="text",n.name=`oldSerialNumber${e}`,n.id=`oldSerialNumber${e}`,n.addEventListener("input",m),a.appendChild(n),t.appendChild(a),a=document.createElement("td"),n=document.createElement("input"),n.type="text",n.name=`newSerialNumber${e}`,n.id=`newSerialNumber${e}`,n.addEventListener("input",m),a.appendChild(n),t.appendChild(a),a=document.createElement("td"),n=document.createElement("input"),n.type="text",n.name=`licensePlate${e}`,n.id=`licensePlate${e}`,n.addEventListener("input",m),a.appendChild(n),t.appendChild(a),a=document.createElement("td");let r=document.createElement("button");return r.type="button",r.className="delete-row-btn",r.textContent="\xD7",r.addEventListener("click",function(){Z(t)}),a.appendChild(r),t.appendChild(a),t}function ge(){k++;let e=document.getElementById("parts-table-body");e&&(e.appendChild(ne(k)),m())}function Z(e,t=null){let a=document.getElementById("parts-table-body"),n=p==="dbd"?2:1;a&&a.children.length>n&&(e.remove(),t&&t.remove(),m())}function ae(e){let t=document.createElement("tr");t.dataset.rowIndex=e;let a=document.createElement("td"),n=document.createElement("input");n.type="text",n.name=`dbdSerialNumber${e}`,n.id=`dbdSerialNumber${e}`,n.addEventListener("input",m),a.appendChild(n),t.appendChild(a),a=document.createElement("td"),n=document.createElement("input"),n.type="text",n.name=`slotNumber${e}`,n.id=`slotNumber${e}`,n.addEventListener("input",m),a.appendChild(n),t.appendChild(a),a=document.createElement("td");let r=document.createElement("button");return r.type="button",r.className="delete-row-btn",r.textContent="\xD7",r.addEventListener("click",function(){we(t)}),a.appendChild(r),t.appendChild(a),t}function Ce(){N++;let e=document.getElementById("dbds-table-body");e&&(e.appendChild(ae(N)),m())}function we(e){let t=document.getElementById("dbds-table-body");t&&t.children.length>1&&(e.remove(),m())}function ve(e){let t=e.target,a=t.value;document.querySelectorAll(`.conditional-field[data-depends-on="${t.id}"]`).forEach(r=>{let d=r.getAttribute("data-depends-value");a===d?r.style.display="block":(r.style.display="none",r.querySelectorAll("input, textarea, select").forEach(l=>l.value=""))}),m()}function m(){let e={},t=T[p];if(t.fields.forEach(n=>{let r=document.getElementById(n.name);r&&(n.type==="checkbox"?e[n.name]=r.checked?u:"":e[n.name]=r.value)}),["breakfix","dbd","network","mobo"].includes(p)){e.allParts=[];let n=document.getElementById("parts-table-body");if(n){let r=p==="dbd"?"tr.parts-row-primary":"tr";n.querySelectorAll(r).forEach((o,l)=>{let c=o.dataset.rowIndex,i=document.getElementById(`oldSerialNumber${c}`),s=document.getElementById(`newSerialNumber${c}`),h=document.getElementById(`licensePlate${c}`);if(i&&s&&h){let I={id:l+1,oldSerialNumber:i.value,newSerialNumber:s.value,licensePlate:h.value};if(p==="dbd"){let P=document.getElementById(`driveLocation${c}`),V=document.getElementById(`binNumber${c}`);P&&(I.driveLocation=P.value),V&&(I.binNumber=V.value)}e.allParts.push(I)}})}}if(p==="mobo"){e.allDBDs=[];let n=document.getElementById("dbds-table-body");n&&n.querySelectorAll("tr").forEach((d,o)=>{let l=d.dataset.rowIndex,c=document.getElementById(`dbdSerialNumber${l}`),i=document.getElementById(`slotNumber${l}`);if(c&&i){let s={id:o+1,dbdSerialNumber:c.value,slotNumber:i.value};e.allDBDs.push(s)}})}let a=t.format(e);["breakfix","dbd","network","mobo"].includes(p)&&e.partReplaced===u&&e.allParts&&e.allParts.length>0&&(a+=de(e.allParts,p)),p==="mobo"&&e.dbdMoved===u&&e.allDBDs&&e.allDBDs.length>0&&(a+=ie(e.allDBDs)),Y.textContent=a}function Te(){let e=Y.textContent;navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(()=>oe()).catch(()=>U(e)):U(e)}function oe(){q.classList.add("show"),setTimeout(()=>{q.classList.remove("show")},2e3)}function U(e){try{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();let a=document.execCommand("copy");document.body.removeChild(t),a?oe():(console.error("Fallback: Could not copy text"),alert("Could not copy text. Please select the text manually."))}catch(t){console.error("Fallback: Could not copy text",t),alert("Could not copy text. Please select the text manually.")}}function ke(){y.reset(),document.querySelectorAll('#template-form input[type="checkbox"]').forEach(e=>{e.checked=!1}),M(),k=0,N=0,m()}})();
